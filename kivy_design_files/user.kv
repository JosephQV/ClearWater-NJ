<UserScreen>:
    name: "user_screen"

    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        size: root.width, root.height

        BackMenuBar:
            title_text: "My Profile"
            back_screen: "home_screen"

        FloatLayout:
            size_hint: 1.00, 0.90

            Label:
                text: "Welcome, " + app.user_data["username"]
                color: "#000000"
                text_size: root.width, None
                size: self.texture_size
                halign: "left"
                padding: 10
                size_hint: None, None
                pos_hint: {"center_x": 0.50, "top": 0.95}

            Label:
                text: "Email: " + app.user_data["email"]
                color: "#000000"
                text_size: root.width, None
                size: self.texture_size
                halign: "left"
                padding: 10
                size_hint: None, None
                pos_hint: {"center_x": 0.50, "top": 0.85}

            Label:
                text: "Municipality: " + app.user_data["municipality"] + ", " + app.user_data["county"] + " County"
                color: "#000000"
                text_size: root.width, None
                size: self.texture_size
                halign: "left"
                padding: 10
                size_hint: None, None
                pos_hint: {"center_x": 0.50, "top": 0.75}

            Label:
                text: "Water System: " + app.user_data["water_system"]
                color: "#000000"
                text_size: root.width, None
                size: self.texture_size
                halign: "left"
                padding: 10
                size_hint: None, None
                pos_hint: {"center_x": 0.50, "top": 0.65}

            Label:
                text: "My Water Tests (" + str(len(app.user_data["water_tests"])) + "):"
                color: "#000000"
                text_size: root.width, None
                size: self.texture_size
                halign: "left"
                padding: 10
                size_hint: None, None
                pos_hint: {"center_x": 0.50, "top": 0.55}

            Button:
                text: "View All Water Tests"
                background_down: ""
                background_normal: ""
                text_size: self.width, None
                background_color: app.colors["secondary"]["rgba"]
                size: 500, 75
                padding: 10
                halign: "center"
                size_hint: None, None
                pos_hint: {"center_x": 0.50, "top": 0.45}
                on_press:
                    app.root.switch_screens("all_water_tests_screen", None)

            Button:
                text: "Edit User Info"
                background_down: ""
                background_normal: ""
                text_size: self.width, None
                background_color: app.colors["secondary"]["rgba"]
                size: 400, 100
                padding: 10
                halign: "center"
                size_hint: None, None
                pos_hint: {"center_x": 0.50, "top": 0.15}
                on_press:
                    app.root.switch_screens("userdata_screen", None)
                    
<UserDataScreen>:
    name: "userdata_screen"

    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"
        size: root.width, root.height

        BackMenuBar:
            title_text: "Edit User Information"
            back_screen: "user_screen"

        UserDataForm:


<UserDataForm>:
    size: root.width, root.height
    padding: 12

    Label:
        text: "Username: "
        color: "#000000"
        text_size: self.width, None
        size: 500, 75
        size_hint: None, None
        pos_hint: {"center_x": 0.5, "top": 0.97}
        halign: "center"
        padding: 10

    TextInput:
        hint_text: ""
        text: root.username
        on_text: root.username = self.text
        multiline: False
        size: 500, 75
        size_hint: None, None
        pos_hint: {"center_x": 0.5, "top": 0.90}
        halign: "center"
        padding: 10

    Label:
        text: "Email: "
        color: "#000000"
        text_size: self.width, None
        size: 500, 75
        size_hint: None, None
        pos_hint: {"center_x": 0.5, "top": 0.83}
        halign: "center"
        padding: 10

    TextInput:
        hint_text: ""
        text: root.email
        on_text: root.email = self.text
        multiline: False
        size: 500, 75
        size_hint: None, None
        pos_hint: {"center_x": 0.5, "top": 0.66}
        halign: "center"
        padding: 10

    Label:
        text: "NJ County: "
        color: "#000000"
        text_size: self.width, None
        size: 500, 75
        size_hint: None, None
        pos_hint: {"center_x": 0.5, "top": 0.59}
        halign: "center"
        padding: 10

    CountyDropDown:
        id: county_dropdown
        text: root.county
        size: 500, 75
        size_hint: None, None
        pos_hint: {"center_x": 0.5, "top": 0.52}
        background_color: app.colors["secondary"]["rgba"]
        background_down: ""
        background_normal: ""
        on_text:
            root.county = self.text
            municipality_dropdown.create_selection()

    Label:
        text: "NJ Municipality (Your Town or City): "
        color: "#000000"
        text_size: self.width, None
        size: 500, 75
        size_hint: None, None
        pos_hint: {"center_x": 0.5, "top": 0.45}
        halign: "center"
        padding: 10

    MunicipalityDropDown:
        id: municipality_dropdown
        text: root.municipality
        size: 500, 75
        size_hint: None, None
        disabled: county_dropdown.text == ""
        pos_hint: {"center_x": 0.5, "top": 0.38}
        background_color: app.colors["secondary"]["rgba"]
        background_down: ""
        background_normal: ""
        county_filter: county_dropdown.text
        on_text: 
            root.municipality = self.text
            watersystem_dropdown.create_selection()

    Label:
        text: "Your Water System: "
        color: "#000000"
        text_size: self.width, None
        size: 500, 75
        size_hint: None, None
        pos_hint: {"center_x": 0.5, "top": 0.31}
        halign: "center"
        padding: 10

    WaterSystemDropDown:
        id: watersystem_dropdown
        text: root.water_system
        size: 500, 75
        size_hint: None, None
        disabled: municipality_dropdown.text == ""
        pos_hint: {"center_x": 0.5, "top": 0.24}
        background_color: app.colors["secondary"]["rgba"]
        background_down: ""
        background_normal: ""
        county_filter: municipality_dropdown.text
        on_text: root.water_system = self.text

    Button:
        text: "Submit"
        size: 500, 75
        size_hint: None, None
        pos_hint: {"center_x": 0.5, "top": 0.17}
        background_normal: ""
        background_color: app.colors["secondary"]["rgba"]
        background_down: ""
        on_press: 
            app.user_data = root.submit_user_data()
            app.root.switch_screens("user_screen", None)

